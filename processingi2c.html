<blockquote style="margin:0 0 0 40px;border:none;padding:0px">The purpose.<br>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">By using the Processing and Arduino, access to easily i2c device from Processing.</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px"><br>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">Why Processing?<br>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">It is possible to make a quick code. Time reduction of trial and error.</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div><span style="background-color:transparent"><br>
</span></div>
</div>
<div><span style="background-color:transparent">I create a short project that utilizes the Processing and Arduino, access to i2c slave device.<br>
-&gt; <a href="https://drive.google.com/open?id=0Bzw-k3D32i_mUUV1NFF1M1pjWVk&amp;authuser=0" target="_blank">Download</a>&nbsp;2015.4.2 update. ( modify, small bug. )</span></div>
<div><span style="background-color:transparent"><br>
</span></div>
<div><i>Processing sketch. Sketch of Arduino is commented in.</i></div>
</blockquote>
<div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
</div>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div>
<div><b>Mechanism.</b></div>
</div>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div>
<div>Processing and Arduino to communicate with serial.</div>
</div>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div>
<div>Format, command + data.</div>
</div>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div>
<div>Arduino sequentially processing the data, depending on the command.</div>
</div>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div>
<div>If there is a response from the slave device i2c, Arduino transmits data in serial to Processing.</div>
</div>
</div>
</blockquote>
</blockquote>
<div>
<h2><span style="font-weight:normal;background-color:transparent"><br>
</span></h2>
</div>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<h2><span style="background-color:transparent">Include sample.<br>
</span></h2>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<h2><span style="font-weight:normal;background-color:transparent">read the EEProm.</span></h2>
</div>
</blockquote>
<div>
<div>
<div class="sites-codeblock sites-codesnippet-block"><code>readFromEEProm( 0x52, 0, 32 );</code></div>
</div>
<div><br>
</div>
</div>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div>Code is as follows.</div>
</div>
<div>
<div>Device address 0x52</div>
</div>
<div>
<div>Read start address 0x00</div>
</div>
<div>
<div>Read data 32 byte</div>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div><br>
</div>
</div>
<div><br>
</div>
<div>
<div>The function.</div>
</div>
</blockquote>
<div>
<div><br>
</div>
<div>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>void readFromEEProm( int deviceAddress, int startAddress, int dataLength ){</code></div>
<div><code>&nbsp; setDeviceAddress( deviceAddress );</code></div>
<div><code>&nbsp; setData( (startAddress &amp; 0xff00) &gt;&gt; 8 ); // address MSB</code></div>
<div><code>&nbsp; setData( startAddress &amp; 0xff ); // address LSB</code></div>
<div><code>&nbsp; endTransmission();</code></div>
<div><code>&nbsp; readRequest( dataLength );</code></div>
<div><code>&nbsp; readData();</code></div>
<div><code>}</code></div>
</div>
</div>
<div><br>
</div>
</div>
<div><br>
</div>
<div><br>
</div>
<h2>Example, SainSmart Tiny RTC</h2>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>What's Tiny RTC? -&gt;&nbsp;<a href="http://www.sainsmart.com/sainsmart-arduino-i2c-rtc-ds1307-at24c32-real-time-clock-module-for-avr-arm-pic.html" target="_blank">SainSmart Arduino I2C RTC&nbsp;<span style="background-color:transparent">DS1307 AT24C32 Real Time Clock Module for AVR ARM PIC</span></a></div>
<div><br>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>To understand how to use the i2c master of Processing, let's try.</div>
<div><span style="background-color:transparent">Read and write to Tiny RTC!!</span></div>
</blockquote>
<div><br>
</div>
<div>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div><b>REQUIRED</b></div>
<div>
<div class="sites-codeblock sites-codesnippet-block"><code>import java.util.*;</code></div>
</div>
<div>Processing is because there is no instruction to extract a week.</div>
<div>Add to the beginning of the sketch.</div>
<div><br>
</div>
<div><br>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div><b>BCD Format</b></div>
<div>
<div>"Tiny RTC" with the date, the time in BCD format.</div>
<div>Added function for conversion.</div>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>int bcdHex( int data ){</code></div>
<div><code>&nbsp; int m = 0;</code></div>
<div><code>&nbsp; while( data &gt; 9 ){</code></div>
<div><code>&nbsp; &nbsp; m ++;</code></div>
<div><code>&nbsp; &nbsp; data = data - 10;</code></div>
<div><code>&nbsp; }</code></div>
<div><code>&nbsp; m = (m &lt;&lt; 4) | data;</code></div>
<div><code>&nbsp; return m;</code></div>
<div><code>}</code></div>
</div>
</div>
<div>
<div><i>Possibly there may be a way that can be resolved to smart.</i></div>
<div><i>I wrote code like this for you did not think of immediately, but if should use it as long as you know the smart solution.</i></div>
</div>
<div><br>
</div>
<div><br>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px"><b>Set Date and Time<br>
</b><br>
</blockquote>
</div>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>Procedure.</div>
<div>Stop, set the date and time, and resume.<br>
</div>
</blockquote>
<div>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>// stop Tiny RTC</code></div>
<div><code>setDeviceAddress( 0x68 );</code></div>
<div><code>setData( 0x00 );</code></div>
<div><code>setData( 0x80 ); // set RTC stop bit</code></div>
<div><code>endTransmission();</code></div>
<div><br>
</div>
<div><code>// set Date Time</code></div>
<div><code>setDeviceAddress( 0x68 );</code></div>
<div><code>setData( 0x01 ); // write start address</code></div>
<div><code>setData( bcdHex(minute()) );</code></div>
<div><code>setData( bcdHex(hour()) );</code></div>
<div><code>setData( new Date().getDay() + 1 ); //week</code></div>
<div><code>setData( bcdHex(day()) );</code></div>
<div><code>setData( bcdHex(month()) );</code></div>
<div><code>setData( bcdHex(year() - 2000) );</code></div>
<div><code>endTransmission();</code></div>
<div><br>
</div>
<div><code>// start Tiny RTC</code></div>
<div><code>setDeviceAddress( 0x68 );</code></div>
<div><code>setData( 0x00 );</code></div>
<div><code>setData( bcdHex(second()) );</code></div>
<div><code>endTransmission();</code></div>
</div>
</div>
<div><br>
</div>
<div><br>
</div>
</blockquote>
<blockquote style="margin:0 0 0 40px;border:none;padding:0px">
<div><b>Read Date and Time.</b></div>
<div><br>
</div>
<div>
<div>Procedure.</div>
<div>Writes the read start address, and to read the data.</div>
</div>
<div>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>setDeviceAddress( 0x68 );</code></div>
<div><code>setData( 0x00 );</code></div>
<div><code>endTransmission();</code></div>
<div><code>readRequest( 0x08 );</code></div>
<div><code>readData();</code></div>
</div>
</div>
<div><br>
</div>
<div><br>
</div>
<div>
<div>How to display the data in the "Processing".</div>
<div>Data RTC is transmitted, are the same as the BCD format when set to RTC.&nbsp;</div>
<div>For example, if the amount of data is the 35 minutes. Data that is sent is 0x35 in hexadecimal.</div>
<div>That, fix to number. or display hexadecimal.</div>
<div><br>
</div>
<div><i>ex)</i></div>
<div><i>print( hex( data ) );</i></div>
</div>
</blockquote>
</div>

